<script src="/penpal.js"></script>
<script src="/pages/_fixtureHelpers.js"></script>
<script src="/shared/generalMethods.js"></script>
<script>
  let parentReturnValue;
  let parentApiPromise;

  const methods = PenpalGeneralFixtureMethods.createGeneralMethods({
    getParentApi: () => parentApiPromise,
    setParentReturnValue: (value) => {
      parentReturnValue = value;
    },
    getParentReturnValue: () => {
      return parentReturnValue;
    },
    getUnclonableValue: () => {
      return window;
    },
    createReply: (value, options) => {
      return new Penpal.Reply(value, options);
    },
    reload: () => {
      window.location.reload(true);
    },
    navigate: (to) => {
      window.location.href = to;
    },
  });

  parentApiPromise = PenpalFixture.connect({
    methods,
    allowedOrigins: ['*'],
  }).promise;
</script>
